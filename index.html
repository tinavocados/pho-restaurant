<html>

<head>
    <link rel="stylesheet" href="vietRes.css">
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    

</head>

<body>
    <br>
    <h1 id="title">Pho Na</h1>
    <p id="address">"The real deal!" -Mr. Kam</p>

    <br>
    
    <div class="allboxes">
        <div class="box" id="pho0">
           <p id="label">pho - $10.00</p>
            <p id="amount0"></p>
            <input type="integer" id="quantity" placeholder="Enter amount">
            <button onclick="purchase0()">purchase</button>
        </div>
    

        <div class="box" id="pork1">
           <p id="label">grilled pork - $7.00</p>
            <p id="amount1"></p>
            <input type="integer" id="quantity1" placeholder="Enter amount">
            <button onclick="purchase1()">purchase</button>
        </div>
    </div>

    <div class="row">
        <div class="box" id="crab2">
          <p id="label">crab soup - $10.00</p>
            <p id="amount2"></p>
            <input type="integer" id="quantity2" placeholder="Enter amount">
            <button onclick="purchase2()">purchase</button>
        </div>
   
       
        <div class="box" id="spring3">
         <p id="label">fresh spring rolls - $5.00</p>
            <p id="amount3"></p>
            <input type="integer" id="quantity3" placeholder="Enter amount">
            <button onclick="purchase3()">purchase</button>
        </div>
    </div>

    <div class="row">
        <div class="box" id="banhmi4">
            <p id="label">banh mi - $7.50</p>
            <p id="amount4"></p>
            <input type="integer" id="quantity4" placeholder="Enter amount">
            <button onclick="purchase4()">purchase</button>
        </div>
   
      
        <div class="box" id="banhxeo5">
          <p id="label">banh xeo - $7.50</p>
            <p id="amount5"></p>
            <input type="integer" id="quantity5" placeholder="Enter amount">
            <button onclick="purchase5()">purchase</button>
        </div>
    </div>

    <div id="showPurchase">
        <h1 id="yourOrder">Total Purchase</h1>
        <ul id="orderList"></ul>
        <p id="totalDisplay"></p>
        <p id="taxTotal"></p>
        <button onclick="totalItems()">checkout</button>
    </div>


    <script>
        var foodName = [];
        var foodPrices = [];
        var total = [];
        var food0name;
        var food0price;
        
        var xmlhttp = new XMLHttpRequest(); //I want to begin a new file request from the server
        xmlhttp.onreadystatechange = function () { //Do this function to check if it is ready
            if (this.readyState == 4 && this.status == 200) { //If the server is ready(4) and the file is available(200)
                var mydata = JSON.parse(this.responseText); //Save the JSOn file as mydata and convert it in a readable format.
                for (var i = 0; i < mydata.food.length; i++) {
                    foodName.push(mydata.food[i].name);
                    foodPrices.push(mydata.food[i].price);
                }
               
               
                food0price = mydata.food[0].price;
                document.getElementById('amount0').innerHTML = "$" + mydata.food[0].price + ".00";
               
                food1price = mydata.food[1].price;
                document.getElementById('amount1').innerHTML = "$" + mydata.food[1].price + ".00";
               
                food2price = mydata.food[2].price;
                document.getElementById('amount2').innerHTML = "$" + mydata.food[2].price;
                
                document.getElementById('amount3').innerHTML = "$" + mydata.food[3].price;
               
                
                food4price = mydata.food[4].price;
                document.getElementById('amount4').innerHTML = "$" + mydata.food[4].price;
              
                food5price = mydata.food[5].price;
                document.getElementById('amount5').innerHTML = "$" + mydata.food[5].price;
               
            }
        };
        xmlhttp.open("GET", "vietRes.json", true); //I will GET a file called vietRes.json
        xmlhttp.send(); //Send to the browser
       
        function purchase0() {
            //Get the value of the quantity field//
            var qty = document.getElementById('quantity').value;
            var subtotal = qty * foodPrices[0];
            total.push(subtotal * 1.04712.toFixed(2));
            document.getElementById('quantity').value = "";
            var node = document.createElement('li');
            var textNode = document.createTextNode(qty + " x " + foodName[0]);
            node.appendChild(textNode);
            document.getElementById("orderList").appendChild(node);
            //I am creating a LOCAL variable called sum and reducing the total array.//
            var sum = total.reduce(add, 0);
            //This function within a function will return the value from low to high and add them together.//
            function add(a, b) {
                return a + b;
            }
            //I output the SUM of everything in the total array and fix the decimal places to 2//
            document.getElementById('total').innerHTML = "Total: $" + sum.toFixed(2);
        }
       
        function purchase1() {
            var qty = document.getElementById('quantity1').value;
            var subtotal = qty * foodPrices[1];
            total.push(subtotal * 1.04712.toFixed(2));
            document.getElementById('quantity1').value = "";
            var node = document.createElement('li');
            var textNode = document.createTextNode(qty + " x " + foodName[1]);
            node.appendChild(textNode);
            document.getElementById("orderList").appendChild(node);
            var sum = total.reduce(add, 0);
            function add(a, b) {
                return a + b;
            }
            document.getElementById('total').innerHTML = "Total: $" + sum.toFixed(2);
        }
        
        function purchase2() {
            var qty = document.getElementById('quantity2').value;
            var subtotal = qty * foodPrices[2];
            total.push(subtotal * 1.04712.toFixed(2));
            document.getElementById('quantity2').value = "";
            var node = document.createElement('li');
            var textNode = document.createTextNode(qty + " x " + foodName[2]);
            node.appendChild(textNode);
            document.getElementById("orderList").appendChild(node);
            var sum = total.reduce(add, 0);
            function add(a, b) {
                return a + b;
            }
            document.getElementById('total').innerHTML = "Total: $" + sum.toFixed(2);
        }
    
        function purchase3() {
            var qty = document.getElementById('quantity3').value;
            var subtotal = qty * foodPrices[3];
            total.push(subtotal * 1.04712.toFixed(2));
            document.getElementById('quantity3').value = "";
            var node = document.createElement('li');
            var textNode = document.createTextNode(qty + " x " + foodName[3]);
            node.appendChild(textNode);
            document.getElementById("orderList").appendChild(node);
            var sum = total.reduce(add, 0);
            function add(a, b) {
                return a + b;
            }
            document.getElementById('total').innerHTML = "Total: $" + sum.toFixed(2);
        }
       
        function purchase4() {
            var qty = document.getElementById('quantity4').value;
            var subtotal = qty * foodPrices[4];
            total.push(subtotal * 1.04712.toFixed(2));
            document.getElementById('quantity4').value = "";
            var node = document.createElement('li');
            var textNode = document.createTextNode(qty + " x " + foodName[4]);
            node.appendChild(textNode);
            document.getElementById("orderList").appendChild(node);
            var sum = total.reduce(add, 0);
            function add(a, b) {
                return a + b;
            }
            document.getElementById('total').innerHTML = "Total: $" + sum.toFixed(2);
        }
       
        function purchase5() {
            var qty = document.getElementById('quantity5').value;
            var subtotal = qty * foodPrices[5];
            total.push(subtotal * 1.04712.toFixed(2));
            document.getElementById('quantity5').value = "";
            var node = document.createElement('li');
            var textNode = document.createTextNode(qty + " x " + foodName[5]);
            node.appendChild(textNode);
            document.getElementById("orderList").appendChild(node);
            var sum = total.reduce(add, 0);
            function add(a, b) {
                return a + b;
            }
            document.getElementById('total').innerHTML = "Total: $" + sum.toFixed(2);
        }
   
        var order= [];
        function totalItems() {
            var sum = total.reduce(add, 0);
            function add(a, b) {
                return a + b;
                }
            var pleaseWork= order.push("orderList");
            location.href = "vietRes2.html";
        }
        
        
        var previous= null;
        var current= null;
        setInterval(function() {
        $.getJSON("vietRes.json",function(json){
            current=JSON.stringify(json);
            if (previous && current&& previous!==current) {
      
            location.reload();
        }
        previous==current;
            });
        }, 2000);
    </script>

</body>

</html>
